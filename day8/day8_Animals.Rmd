---
title: "Untitled"
author: "Sung Inkyung"
date: '2021 6 8 '
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(ggforce)
```


```{r}
animal_outcomes <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-07-21/animal_outcomes.csv')

animal_outcomes %>% 
  count(year, sort = T) #1999-2018

animal_outcomes %>% 
  count(outcome, sort = T)

animal_outcomes %>% 
  count(animal_type, sort = T)


```
```{r}
dog_outcome <- animal_outcomes %>% 
  filter(animal_type == "Dogs") %>% 
  select(year, animal_type, outcome, total = Total) %>% 
  mutate(outcome = case_when(
    outcome %in% c("Reclaimed", "Rehomed", "Transferred")  ~ "Rescued",
    outcome == "Euthanized" ~ "Euthanized",
    TRUE ~ "Other"),
    outcome = factor(outcome),
    outcome = fct_relevel(outcome, "Euthanized", "Rescued", "Other")) %>% 
  group_by(year, outcome) %>% 
  summarise(count = sum(total)) %>% 
  mutate(prc = count / sum(count),
         prc = round(prc, 2))

dog_outcome %>% 
  count(prc, sort = T)
```


```{r}
desc <- "Rate of being euthanized are over 80% since 2015."
  
plot <- dog_outcome %>% 
  ggplot(aes(year, prc)) +
  geom_line(aes(color = outcome),
            size = 1.3) + 
  geom_mark_ellipse(aes(x = 2015, y = .8,
                       label = "Euthanized"),
                   label.buffer = unit(20, "mm"),
                   label.minwidth = unit(30, "mm"),
                   label.fontsize = c(11, 9),
                   label.fill = "#dad9d7",
                   description = desc) +
  scale_x_continuous(limits = c(2000, 2018),
                     breaks = seq(2000, 2018, 5)) +
  scale_y_continuous(limits = c(0, 1),
                     breaks = seq(0, 1, .25),
                     labels = scales::percent_format()) +
  scale_color_manual(values = c("#fcba03", "#805b00", "#93bd8c"), 
                     name = " ") +
  labs(x = "",
       y = "",
       title = "Dog's Life in Australia",
       subtitle = "Dogs have been less likely to have chances to be rehomed, reclaimed or transferred",
       caption = "Source: RSPCA | #30DayChartChallenge | Graphic: Sung Inkyung") +
  theme_light() +
  theme(legend.position = "top",
        legend.background = element_rect(fill = "#dad9d7"),
        legend.key = element_rect(fill = "#dad9d7"),
        plot.background = element_rect(fill = "#dad9d7"),
        panel.background = element_rect(fill = "#dad9d7"),
        plot.title = element_text(size = 24, 
                                  hjust = .5, 
                                  margin = margin(t = 15, b = 7)),
        plot.subtitle = element_text(size= 14, 
                                     hjust = .5,
                                     margin = margin(b = 20)),
        plot.caption = element_text(size = 9,
                                    hjust = .5))
  
  
ggsave(here::here("day8", "day8_Animals.png"), width = 30, height = 20, units = "cm")

```


```{r}
```

